"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const e=e=>e.replace("[","\\[").replace("]","\\]"),t=e=>{if(!e)return null;const t=e.match(/([A-Z]+)\s+(\S+)\s+([A-Z]+\/[\d\.]+)/);return t?{method:t[1],resource:t[2],protocol:t[3]}:null};exports.parse=function(r){const s={remotehost:null,ident:null,authuser:null,date:null,request:null,status:null,bytes:null,referrer:null,agent:null},u={remotehost:" ",ident:" ",authuser:" [",date:"] ",request:'" ',status:" ",bytes:" ",referrer:' "',agent:'" "'};return Object.keys(s).forEach((l=>{const n=u[l];let o,c=r.match(e(n));null===c&&(c=r.match(e(n.slice(0,1))),o=null===c?r:r.substring(0,c.index),"request"!==l?s[l]=o:s.request=t(o)),o=r.substring(0,c.index),o="-"===o?null:o,r=r.substring(c.index+n.length),"request"===l?s.request=t(o):s[l]=o})),s};
